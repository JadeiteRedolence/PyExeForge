# PyWin32Exec - Python程序打包工具

一个简单易用但功能强大的Python程序打包工具。它可以将Python脚本转换为独立的可执行文件,并提供丰富的自定义选项。

## 目录
- [概述](#概述)
- [前提条件](#前提条件)
- [功能特性](#功能特性)
- [技术细节](#技术细节)
- [安装](#安装)
- [使用方法](#使用方法)
- [配置](#配置)
- [工作原理](#工作原理)
- [性能考虑](#性能考虑)
- [故障排除](#故障排除)
- [贡献](#贡献)

## 概述

PyWin32Exec是一个专业的Python程序打包工具,旨在简化Python脚本向可执行文件的转换过程。它基于PyInstaller构建,提供了友好的用户界面和丰富的自定义选项,使得打包过程变得简单直观。该工具特别适合需要将Python程序分发给最终用户的开发者。

## 前提条件

### 系统要求
- Windows操作系统(需要PowerShell支持)
- Python 3.6或更高版本
- 建议最少4GB内存
- 足够的磁盘空间用于打包过程

### 软件依赖
- PyInstaller必须正确安装
  - 可通过`pip install pyinstaller`安装
- Python包:
  - tkinter(通常随Python一起提供)
  - os
  - datetime
  - time

## 功能特性

### 核心功能
- 将Python脚本转换为独立的可执行文件
- 自定义输出文件名和版本信息
- 添加UAC管理员权限
- 生成单文件程序
- 自动文件管理和组织

### 版本信息管理
- 自定义程序版本号
- 自定义公司信息
- 自定义文件描述
- 自定义版权信息
- 自定义产品信息

### 文件管理
- 自动处理输出文件命名
- 智能文件组织系统
- 临时文件自动清理
- 工作目录管理

## 技术细节

### 打包实现
工具使用PyInstaller作为核心打包引擎,并进行了以下优化:
- 单文件模式(-F选项)确保输出整洁
- UAC管理员权限支持
- 自定义版本信息文件生成
- 工作目录优化

### 处理流程
1. 用户输入基本信息
2. 选择源Python文件
3. 生成版本信息文件
4. 构建PyInstaller命令
5. 执行打包过程
6. 清理临时文件

### 版本信息管理
- 动态生成版本信息文件
- 支持多语言环境
- 完整的文件属性设置
- 自定义公司和版权信息

## 安装

1. 确保Python环境正确安装:
   ```bash
   python --version
   ```

2. 安装PyInstaller:
   ```bash
   pip install pyinstaller
   ```

3. 下载或克隆工具:
   ```bash
   git clone [仓库地址]
   cd PyDevelopmentTools
   ```

## 使用方法

### 基本操作
1. 运行脚本:
   ```bash
   python PyWin32Exec.py
   ```

2. 输入基本信息:
   - 程序基础名称
   - 程序版本号
   - 构建日期会自动生成

3. 选择源文件:
   - 通过文件对话框选择.py文件
   - 支持所有Python脚本文件

4. 自定义输出选项:
   - 输出文件名(可选)
   - 版本信息文件名(可选)

5. 等待处理完成:
   - 查看命令执行过程
   - 检查输出结果

### 高级用法
- 自定义版本信息:
  1. 修改公司名称
  2. 设置文件描述
  3. 配置版权信息
  4. 添加产品信息

- 输出管理:
  1. 自定义输出文件名
  2. 自动清理临时文件
  3. 组织输出结构

## 配置

### 可调参数
- `INIT_DIR`: 初始源文件目录
- `OUTPUT_DIR`: 输出文件目录
- 版本信息模板
- 文件命名格式

### 版本信息配置
- 公司名称
- 文件描述
- 版权文本
- 产品信息
- 注释信息

## 工作原理

### 文件分析
1. **源文件验证**
   ```python
   def get_py_file():
       # 通过文件对话框选择Python文件
       # 返回文件完整路径
   ```

2. **名称处理**
   ```python
   def get_custom_names():
       # 处理自定义文件名
       # 生成输出文件名和版本文件名
   ```

3. **版本信息生成**
   ```python
   def generate_version_info():
       # 创建版本信息文件
       # 包含完整的文件属性
   ```

### 处理逻辑
1. **文件验证**
   - 检查文件存在性
   - 验证文件类型
   - 确保路径有效

2. **打包策略**
   - 构建命令参数
   - 设置输出选项
   - 配置版本信息

3. **执行流程**
   - 命令执行监控
   - 错误处理
   - 结果验证

## 性能考虑

### 优化技术
- 合理的工作目录设置
- 临时文件管理
- 资源使用优化
- 命令执行效率

### 资源使用
- CPU: 打包过程占用
- 内存: 临时文件处理
- 磁盘: 输出文件管理
- 系统: UAC权限控制

### 处理时间因素
- 源文件大小
- 依赖项数量
- 系统性能
- 磁盘速度

## 故障排除

### 常见问题

1. **PyInstaller错误**
   - 检查安装状态
   - 验证Python环境
   - 确认依赖完整性

2. **权限问题**
   - 检查UAC设置
   - 验证文件权限
   - 确认管理员权限

3. **文件访问问题**
   - 检查路径有效性
   - 验证磁盘空间
   - 确认文件可访问

### 错误信息

1. **打包错误**
   - 命令语法问题
   - 依赖项缺失
   - 资源限制

2. **Python错误**
   - 模块导入失败
   - 文件操作问题
   - 权限受限

### 解决方案

1. **安装问题**
   - 重新安装PyInstaller
   - 更新Python环境
   - 验证依赖项

2. **处理问题**
   - 检查源文件
   - 验证输出路径
   - 监控系统资源

## 贡献

### 开发指南
1. Fork仓库
2. 创建特性分支
3. 遵循代码规范
4. 提交拉取请求

### 测试
- 验证PyInstaller兼容性
- 测试不同Python版本
- 验证输出文件
- 检查资源使用

### 文档
- 更新README
- 记录代码变更
- 维护版本历史

## 许可证

本项目采用MIT许可证 - 详见LICENSE文件。

## 致谢

- PyInstaller开发团队
- Python社区
- 开源贡献者
- 所有用户的反馈和建议
